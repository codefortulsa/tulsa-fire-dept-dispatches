{% extends 'base.html' %}
{% block title %}Select a unit{% endblock %}
{% block content %}

<script>
    
    $(document).bind('pageinit',function() {
        
        $("input[type='checkbox']").bind( "change", function( event ) { 
            var urls = $(this).data('state-urls');
            var state = this.checked;
            $.ajax({url: urls[state]});
        });
                
        $("#unit_list").listview('option', 'filterCallback',
            function( text, searchValue, item ){
                return !RegExp(searchValue, "g").test(text.toString().toLowerCase());
            });
        
    });//end of page init
</script>

<div class="ui-grid-solo">
    <legend>You can follow units by text or email</legend>
    </br>
</div>
<form>
    <ul id="unit_list" data-role="listview" data-filter="true" data-placeholder="xxx"> 
    {% for unit in units %}
        <li  data-filtertext="{{unit.id}}">
            <legend>
    
                {{unit.id}}
    
            </legend>   
        
            <div data-role="fieldcontain" >
                <fieldset data-role="controlgroup" data-type="horizontal">
                
             	   <label for="by_phone">Send Text</label><input type="checkbox" 
            	   data-state-urls='{"true":"{% url follow_unit unit.id 'by_phone' 'on' %}","false":"{% url follow_unit unit.id 'by_phone' 'off' %}"}'
            	   {% if unit.by_phone %} checked {% endif %}
            	   name="by_phone" id="by_phone" class="custom" data-mini="true"/>

            	   <label for="by_email">Send Email</label><input type="checkbox" 
            	   data-state-urls='{"true":"{% url follow_unit unit.id 'by_email' 'on' %}","false":"{% url follow_unit unit.id 'by_email' 'off' %}"}'
                   {% if unit.by_email %} checked {% endif %}
            	   name="by_email" id="by_email" class="custom" data-mini="true"/>
    	   
    	   
                </fieldset>
            </div>
        </li>

{% endfor %}
    </ul>
</form>
{% endblock content %}
